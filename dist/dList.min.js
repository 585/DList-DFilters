!function(){angular.module("d.Filters",[]),angular.module("d.Actions",[]),angular.module("d.List",[]),angular.module("d.Keyboard",[]),angular.module("d",["d.Filters","d.Actions","d.List","d.Keyboard","ngSanitize"])}(),angular.module("d").run(["$templateCache",function(e){e.put("action.add-item.tpl.html",'<li>\n    <a href="" ng-click="savm.selectAll()"><i class="glyphicon glyphicon-plus"></i> Add item</a>\n</li>'),e.put("action.delete-items.tpl.html",'<li>\n    <a href="" ng-click="vm.deleteItems()"><i class="glyphicon glyphicon-remove"></i> Delete</a>\n</li>'),e.put("action.select-all.tpl.html",'<li>\n    <a href="" ng-click="savm.selectAll()">Select All</a>\n</li>'),e.put("action.select-inverse.tpl.html",'<li>\n    <a href="" ng-click="sivm.selectInverse()">Select Inverse</a>\n</li>'),e.put("action.select-none.tpl.html",'<li>\n    <a href="" ng-click="snvm.selectNone()">Select None</a>\n</li>'),e.put("action-box.tpl.html",'<div class="btn-group">\n	<button class="btn btn-primary btn-{{size}} dropdown-toggle" type="button" data-toggle="dropdown" aria-expanded="false">\n		<span class="glyphicon glyphicon-{{icon}}" aria-hidden="true"></span> <span ng-bind="label"></span> <span class="caret"></span>\n	</button>\n	<ul class="dropdown-menu" role="menu" ng-transclude></ul>\n</div>\n'),e.put("filters.tpl.html",'<form role="form" class="row">\n    <div ng-repeat="field in $filters.$fields" ng-switch="field.type">\n        <div class="form-group col-xs-{{field.size}}" ng-switch-when="text">\n            <label for="{{field.ngModel}}">{{field.label}}</label>\n            <input type="text" name="{{field.ngModel}}" class="form-control" ng-model="$filters.$model[field.ngModel]" />\n        </div>\n        <div class="form-group col-xs-{{field.size}}" ng-switch-when="select">\n            <label for="{{field.ngModel}}">{{field.label}}</label>\n            <select name="{{field.ngModel}}" class="form-control" ng-model="$filters.$model[field.ngModel]" ng-options="option.key as option.value for option in field.ngOptions">\n            </select>\n        </div>\n        <div class="checkbox col-xs-{{field.size}}" ng-switch-when="checkbox">\n            <label>\n                <input type="checkbox" ng-model="$filters.$model[field.ngModel]"/>{{field.label}}\n            </label>\n        </div>\n    </div>\n    <button class="btn btn-primary" ng-click="$filters.submit()">Submit</button>\n    {{$filters.$model}}\n</form>\n'),e.put("edit-input.tpl.html",'<div class="form-group">\n    <select ng-if="vm.setup.type === \'select\'" ng-model="vm.editValue" ng-options="option for option in vm.selectDataOptions" class="form-control">\n    </select>\n    <input ng-if="vm.setup.type !== \'select\'" type="text" class="form-control" ng-model="vm.editValue">\n</div>'),e.put("edit-mode-button.tpl.html",'<span class="pull-right">\n    <button class="btn btn-{{size}} btn-primary" ng-if="!$parent.$list.$edit" type="button" ng-click="vm.changeEditMode()">\n        <span class="glyphicon glyphicon-edit" aria-hidden="true"></span> \n        <span>Edit</span>\n    </button>\n    \n    <button class="btn btn-{{size}} btn-success" ng-if="$parent.$list.$edit" type="button" ng-click="vm.saveEditData()">\n        <span class="glyphicon glyphicon-floppy-saved" aria-hidden="true"></span> \n        <span>Save</span>\n    </button>\n    \n    <button class="btn btn-{{size}} btn-default" ng-if="$parent.$list.$edit" type="button" ng-click="vm.cancelEditData()">\n        <span class="glyphicon glyphicon-remove" aria-hidden="true"></span> \n        <span>Cancel</span>\n    </button>\n</span>'),e.put("list.tpl.html",'<div>\n    <div ng-transclude></div>\n    <br/>\n\n    <table class="table table-hover">\n        <thead ng-if="$list.$setup.enable.header">\n            <tr>\n                <th ng-if="$list.$setup.enable.checkboxes"></th>\n                <th ng-repeat="header in $list.$headers">\n                    <a ng-if="$list.headerIsSortable(header)" href="" ng-click="$list.sortBy(header)">{{header | capitalize}}\n                        <i ng-if="$list.$sort.by === header" class="glyphicon" ng-class="{\'glyphicon-chevron-down\': $list.$sort.order === \'desc\', \'glyphicon-chevron-up\': $list.$sort.order === \'asc\'}" style="font-size: 10px; margin: 4px 0 0 4px"></i>\n                    </a>\n                    <span ng-if="!$list.headerIsSortable(header)">\n                        {{header | capitalize}}\n                    </span>\n                </th>\n            </tr>\n        </thead>\n        <tfoot ng-if="$list.$setup.enable.footer"></tfoot>\n        <tbody>\n            <tr ng-repeat="element in $list.$elements">\n                <td ng-if="$list.$setup.enable.checkboxes">\n                    <input type="checkbox" ng-model="element.$checked" />\n                </td>\n                <td ng-hide="$list.$edit" ng-repeat="header in $list.$headers">\n                    <div ng-if="!$list.$setup.templates[header]">{{element[header]}}</div>\n                    <div ng-if="$list.$setup.templates[header]">\n                        <item data-template="$list.$setup.templates[header]" data-model="element"></item>\n                    </div>\n                </td>\n                <td ng-show="$list.$edit" ng-repeat="header in $list.$headers">\n                    <div class="form-group">\n                        <edit-input data-value="element[header]" data-setup="$list.$setup.edit[header]"></edit-input>\n                    </div>\n                </td>\n            </tr>\n        </tbody>\n    </table>\n    <section ng-if="$list.$setup.enable.pagination">\n        <div style="width: 200px" class="input-group">\n            <span ng-bind="$list.$setup.i18n.pagination.prev" ng-click="$list.$pagination.pageDown()" ng-disabled="$list.$pagination.data.page === 1" class="input-group-addon btn"></span>\n            <input type="text" class="form-control" ng-blur="$list.$pagination.ensureValidPage()" ng-model="$list.$pagination.data.page" />\n            <span ng-bind="$list.$setup.i18n.pagination.next" ng-click="$list.$pagination.pageUp()" ng-disabled="$list.$pagination.data.page === $list.$pagination.totalPages()" class="input-group-addon btn"></span>\n        </div>\n        <br />\n        <div>Showing items: {{$list.$pagination.fromItem()}} - {{$list.$pagination.toItem()}} of {{$list.$pagination.data.total}}</div>\n        <div>Selected: {{$list.selected()}}</div>\n        <div>Total pages: {{$list.$pagination.totalPages()}}</div>\n    </section>\n</div>\n')}]),function(){function e(){var e=this;e.url="http://api.icndb.com/jokes/random/38",e.els=[],e.setup={enable:{header:!0,footer:!1,sorting:!0,pagination:!0,filters:!0,checkboxes:!0},defaults:{sort:{order:"asc",by:"surname"},pagination:{pageSize:2,page:1}},i18n:{locale:"en_US",pagination:{next:"Next",prev:"Previous",start:"Start",end:"End"}},data:{onSuccess:function(e){return e.value},onError:function(e){return e}},templates:{name:"<div>This is a custom template for <b>{{$item.name}}</b></div>"},edit:{name:{type:"select",data:["Olivia","Alex","Susanne","Winston"]},surname:{type:"select",dataUrl:"http://api.icndb.com/jokes/random/1"}},columns:{include:["name","surname"],order:[],sortables:["surname"]}},e.elements=[{id:1,name:"Olivia",surname:"Newton",age:32},{id:2,name:"Oliver",surname:"Night",age:12},{id:3,name:"Felicia",surname:"Low",age:43},{id:4,name:"Alex",surname:"Night"},{id:5,name:"Martin",surname:"Fair",age:54}],e.fields=[{type:"text",label:"Name",ngModel:"name"},{type:"select",label:"Sex",ngModel:"sex",ngOptions:[{key:"male",value:"Male"},{key:"female",value:"Female"}]},{type:"checkbox",label:"Single?",ngModel:"single"}]}angular.module("d").controller("MainController",e),e.$inject=[]}(),function(){angular.module("d").filter("capitalize",function(){return function(e){return e?e.replace(/([^\W_]+[^\s-]*) */g,function(e){return e.charAt(0).toUpperCase()+e.substr(1).toLowerCase()}):""}})}(),function(){function e(){return{altPressed:!1}}angular.module("d.Keyboard").service("keyboardService",e)}(),function(){function e(){function e(e){var t=this;e.$watch("$parent.$parent.$list.$elements",function(e){t.elements=e})}return e.$inject=["$scope"],{transclude:!0,templateUrl:"action-box.tpl.html",replace:!0,controller:e,scope:{label:"@",size:"@",icon:"@"},controllerAs:"vm"}}angular.module("d.Actions").directive("actionBox",e)}(),function(){function e(){function e(){}return e.$inject=["$scope"],{restrict:"E",controller:e,templateUrl:"action.add-item.tpl.html",replace:!0}}angular.module("d.List").directive("actionAddItem",e)}(),function(){function e(){function e(e){function t(){var e=[];angular.forEach(n.elements,function(t,n){t.$checked&&e.push(n)}),e.length>0&&angular.forEach(e,function(e){n.elements.splice(e,1)})}var n=this;n.deleteItems=t,e.$watch("$parent.vm.elements",function(e){n.elements=e})}return e.$inject=["$scope"],{restrict:"E",controller:e,controllerAs:"vm",templateUrl:"action.delete-items.tpl.html",replace:!0}}angular.module("d.List").directive("actionDelete",e)}(),function(){function e(e){function t(t){function n(){angular.forEach(a.elements,function(t){e.select(t)})}var a=this;a.selectAll=n,t.$watch("$parent.vm.elements",function(e){a.elements=e})}return t.$inject=["$scope"],{templateUrl:"action.select-all.tpl.html",replace:!0,controller:t,controllerAs:"savm"}}angular.module("d.Actions").directive("actionSelectAll",e),e.$inject=["dCheckboxesService"]}(),function(){function e(e){function t(t){function n(){angular.forEach(a.elements,function(t){e.invert(t)})}var a=this;a.selectInverse=n,t.$watch("$parent.vm.elements",function(e){a.elements=e})}return t.$inject=["$scope"],{templateUrl:"action.select-inverse.tpl.html",replace:!0,controller:t,controllerAs:"sivm"}}angular.module("d.Actions").directive("actionSelectInverse",e),e.$inject=["dCheckboxesService"]}(),function(){function e(e){function t(t){function n(){angular.forEach(a.elements,function(t){e.unselect(t)})}var a=this;a.selectNone=n,t.$watch("$parent.vm.elements",function(e){a.elements=e})}return t.$inject=["$scope"],{templateUrl:"action.select-none.tpl.html",replace:!0,controller:t,controllerAs:"snvm"}}angular.module("d.Actions").directive("actionSelectNone",e),e.$inject=["dCheckboxesService"]}(),function(){function e(e){function t(t){function n(){e.$broadcast(t.listName+"Reload",a.$model)}var a=this;a.$fields=t.fields(),a.$model={},a.submit=n}return t.$inject=["$scope"],{templateUrl:"filters.tpl.html",replace:!0,scope:{listName:"@",setup:"&",fields:"&"},controller:t,controllerAs:"$filters"}}angular.module("d.Filters").directive("dFilters",e),e.$inject=["$rootScope"]}(),function(){function e(){function e(e){e.$checked=!0}function t(e){e.$checked=!1}function n(e){e.$checked=!e.$checked}function a(e){return e.$checked}return{select:e,unselect:t,invert:n,isChecked:a}}angular.module("d").service("dCheckboxesService",e)}(),function(){function e(e){function t(e,t,n){e.size=n.size}function n(t){function n(){t.$parent.$list.$edit=!t.$parent.$list.$edit}function a(){e.$broadcast("dList.cancelEditData"),n()}function i(){e.$broadcast("dList.saveEditData"),n()}var l=this;l.changeEditMode=n,l.saveEditData=i,l.cancelEditData=a}return n.$inject=["$scope"],{templateUrl:"edit-mode-button.tpl.html",replace:!0,link:t,controller:n,controllerAs:"vm"}}angular.module("d.List").directive("editModeButton",e),e.$inject=["$rootScope"]}(),function(){function e(e,t){function n(e){function n(){a.setup.dataUrl?t.get(a.setup.dataUrl).then(function(){a.selectDataOptions=["Newton","Barry","Night"]},function(){console.log("CAUTION: Error while loading external select options from "+a.setup.dataUrl)}):a.setup.data&&(a.selectDataOptions=a.setup.data)}var a=this;a.selectDataOptions=[],a.editValue=e.value,a.setup=e.setup();var i=e.$watch("setup",function(e){e()&&(n(),i())});e.$on("dList.saveEditData",function(){e.value=a.editValue}),e.$on("dList.cancelEditData",function(){a.editValue=e.value})}function a(t,n){n.bind("keyup",function(t){18===t.keyCode&&(e.altPressed=!1)}),n.bind("keydown",function(t){if(18===t.keyCode&&(e.altPressed=!0),e.altPressed){var a,i,l;switch(t.keyCode){case 37:a=angular.element(n.parent().parent()[0].previousElementSibling);break;case 38:var a=angular.element(angular.element(n.parent().parent().parent()[0].previousElementSibling).find("td")[n.parent().parent()[0].cellIndex]);break;case 39:var a=n.parent().parent().next();break;case 40:var a=angular.element(n.parent().parent().parent().next().find("td")[n.parent().parent()[0].cellIndex])}i=a.find("select")[0],l=a.find("input")[0],i&&i.focus(),l&&l.focus()}})}return n.$inject=["$scope"],{templateUrl:"edit-input.tpl.html",replace:!0,controller:n,controllerAs:"vm",link:a,scope:{value:"=",setup:"&"}}}angular.module("d.List").directive("editInput",e),e.$inject=["keyboardService","$http"]}(),function(){function e(e){return{link:function(t,n){n.html(t.template()),e(n.contents())(t)},scope:{template:"&",item:"&model"},controller:["$scope",function(e){var t=this;angular.extend(t,e.item())}],controllerAs:"$item"}}angular.module("d.List").directive("item",e),e.$inject=["$compile"]}(),function(){function e(e,t,n,a,i){function l(e){function n(e){return!u.$setup.columns||!u.$setup.columns.sortables||u.$setup.columns.sortables.indexOf(e)>-1}function l(e){var t=[];for(var n in e)e.hasOwnProperty(n)&&"$"!==n[0]&&(u.$setup.columns&&u.$setup.columns.include?u.$setup.columns.include.indexOf(n)>-1&&t.push(n):t.push(n));return t}function o(){var e=0;return angular.forEach(u.$elements,function(t){i.isChecked(t)&&e++}),e}function s(){if(e.url()){{({page:u.$pagination.data.page,pageSize:u.$pagination.data.pageSize})}a.getData(u.$setup.data.onSuccess,u.$setup.data.onError).then(function(e){p=t("orderBy")(e,u.$sort.by,"desc"===u.$sort.order),r(),u.$pagination.data.total=p.length,c()})}else p=t("orderBy")(e.elements(),u.$sort.by,"desc"===u.$sort.order),r(),u.$pagination.data.total=p.length,c()}function r(){angular.forEach(p,function(e){angular.extend(e,{$checked:!1})})}function c(){u.$elements=p.slice((u.$pagination.data.page-1)*u.$pagination.data.pageSize,u.$pagination.data.pageSize*u.$pagination.data.page)}function d(e){u.$sort.by=e,u.$sort.order=u.$sort.order&&"asc"===u.$sort.order?"desc":"asc",u.$sort.order=u.$sort.order,s()}var u=this,p=[];a.setUrl(e.url()),u.$name=e.name,u.selected=o,u.$edit=!1,u.sortBy=d,u.$setup=e.setup()||{enable:{header:!0,footer:!0,sorting:!0,pagination:!0,filters:!0,checkboxes:!0},defaults:{sort:{order:"asc",by:"name"},pagination:{pageSize:10,page:1}},i18n:{locale:"en_US",pagination:{next:"Next",prev:"Previous",start:"Start",end:"End"}},data:{onSuccess:function(e){return e.value},onError:function(e){return e}}},u.$sort=u.$setup&&u.$setup.defaults?u.$setup.defaults.sort:{},u.$pagination={data:{pageSize:u.$setup.defaults.pagination.pageSize,page:u.$setup.defaults.pagination.page,total:null},pageUp:function(){this.data.page!==this.totalPages()&&(this.data.page++,s())},pageDown:function(){1!==this.data.page&&(this.data.page--,s())},ensureValidPage:function(){this.data.page<1?this.data.page=1:this.data.page>this.totalPages()&&(this.data.page=this.totalPages()),s()},totalPages:function(){return Math.round(this.data.total/this.data.pageSize)},fromItem:function(){return(this.data.page-1)*this.data.pageSize===0?1:(this.data.page-1)*this.data.pageSize},toItem:function(){return this.data.page*this.data.pageSize>this.data.total?this.data.total:this.data.page*this.data.pageSize}},u.headerIsSortable=n,e.$watch(angular.bind(u,function(){return u.$elements}),function(e){e&&e[0]&&(u.$headers=l(e[0]))}),e.$on(u.$name+"Reload",function(e,t){angular.extend({},t,u.$sort,u.$pagination.data)}),s()}return l.$inject=["$scope"],{templateUrl:"list.tpl.html",replace:!0,transclude:!0,scope:{elements:"&",setup:"&",url:"&",name:"@"},controller:l,controllerAs:"$list"}}angular.module("d.List").directive("dList",e),e.$inject=["$http","$filter","$compile","dListService","dCheckboxesService"]}(),function(){function e(e){function t(e){i=e}function n(){return i}function a(t,n,a){var l=a?e.post(i,a):e.get(i);return l.then(function(e){return t(e.data)},function(e){return n(e.data)})}var i;return{setUrl:t,getUrl:n,getData:a}}angular.module("d.List").service("dListService",e),e.$inject=["$http"]}();