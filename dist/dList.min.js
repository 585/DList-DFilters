!function(){angular.module("d.Filters",[]),angular.module("d.Actions",[]),angular.module("d.List",[]),angular.module("d.Keyboard",[]),angular.module("d.Helpers",[])}(),angular.module("d.Filters").run(["$templateCache",function(e){e.put("action-box.tpl.html",'<div class="btn-group">\n	<button class="btn btn-default btn-{{size}} dropdown-toggle" type="button" data-toggle="dropdown" aria-expanded="false" bs-drop-down>\n		<span class="glyphicon glyphicon-{{icon}}" aria-hidden="true"></span> <span ng-bind="label"></span> <span class="caret"></span>\n	</button>\n	<ul class="dropdown-menu" role="menu" ng-transclude></ul>\n</div>\n'),e.put("action.add-item.tpl.html",'<li>\n    <a href="" ng-click="savm.selectAll()"><i class="glyphicon glyphicon-plus"></i> Add item</a>\n</li>'),e.put("action.delete-items.tpl.html",'<li>\n    <a href="" ng-click="vm.deleteItems()"><i class="glyphicon glyphicon-remove"></i> Delete</a>\n</li>'),e.put("action.select-all.tpl.html",'<li>\n    <a href="" ng-click="savm.selectAll()">Select All</a>\n</li>'),e.put("action.select-inverse.tpl.html",'<li>\n    <a href="" ng-click="sivm.selectInverse()">Select Inverse</a>\n</li>'),e.put("action.select-none.tpl.html",'<li>\n    <a href="" ng-click="snvm.selectNone()">Select None</a>\n</li>'),e.put("filters.tpl.html",'<form role="form" class="row d-filters">\n    <div ng-repeat="field in $filters.$fields()" ng-switch="field.type">\n        <div ng-switch-when="text" class="form-group col-xs-{{field.size[0]}} col-sm-{{field.size[1]}} col-md-{{field.size[2]}} col-lg-{{field.size[3]}} d-filters__text-field">\n            <label for="{{field.ngModel}}">{{field.label}}</label>\n            <input type="text" name="{{field.ngModel}}" class="form-control" ng-model="$filters.$model[field.ngModel]"\n                ng-model-options="{ updateOn: \'default blur\', debounce: {\'default\': 500, \'blur\': 0} }" />\n        </div>\n        <div ng-switch-when="select" class="form-group col-xs-{{field.size[0]}} col-sm-{{field.size[1]}} col-md-{{field.size[2]}} col-lg-{{field.size[3]}} d-filters__select-box">\n            <label for="{{field.ngModel}}">{{field.label}}</label>\n            <select name="{{field.ngModel}}" class="form-control" ng-model="$filters.$model[field.ngModel]" ng-options="option.key as option.value for option in field.ngOptions">\n            </select>\n        </div>\n        <div ng-switch-when="checkbox" class="checkbox col-xs-{{field.size[0]}} col-sm-{{field.size[1]}} col-md-{{field.size[2]}} col-lg-{{field.size[3]}} d-filters__checkbox">\n            <label>\n                <input type="checkbox" ng-model="$filters.$model[field.ngModel]"/>{{field.label}}\n            </label>\n        </div>\n        <div ng-switch-when="selectize" class="col-xs-{{field.size[0]}} col-sm-{{field.size[1]}} col-md-{{field.size[2]}} col-lg-{{field.size[3]}} d-filters__selectize">\n            <label for="{{field.ngModel}}">{{field.label}}</label>\n            <selectize ng-model="$filters.$model[field.ngModel]" config="field.config"></selectize>\n        </div>\n        <div ng-switch-when="datePicker" class="col-xs-{{field.size[0]}} col-sm-{{field.size[1]}} col-md-{{field.size[2]}} col-lg-{{field.size[3]}} d-filters__date-picker">\n            <label for="{{field.ngModel}}">{{field.label}}</label>\n            <input type="text" class="form-control" model="$filters.$model[field.ngModel]" date-picker editable/>\n        </div>\n    </div>\n    <button ng-if="!$filters.autoSubmit" class="btn btn-primary d-filters__submit" ng-click="$filters.submit()">Submit</button>\n</form>\n'),e.put("edit-input.tpl.html",'<div class="form-group">\n    <select ng-if="vm.setup.type === \'select\'" ng-model="vm.editValue" ng-options="option for option in vm.selectDataOptions" class="form-control">\n    </select>\n    <input ng-if="vm.setup.type !== \'select\'" type="text" class="form-control" ng-model="vm.editValue">\n</div>'),e.put("edit-mode-button.tpl.html",'<span class="pull-right">\n    <button class="btn btn-{{size}} btn-primary" ng-if="!$parent.$list.$edit" type="button" ng-click="vm.changeEditMode()">\n        <span class="glyphicon glyphicon-edit" aria-hidden="true"></span> \n        <span>Edit</span>\n    </button>\n    \n    <button class="btn btn-{{size}} btn-success" ng-if="$parent.$list.$edit" type="button" ng-click="vm.saveEditData()">\n        <span class="glyphicon glyphicon-floppy-saved" aria-hidden="true"></span> \n        <span>Save</span>\n    </button>\n    \n    <button class="btn btn-{{size}} btn-default" ng-if="$parent.$list.$edit" type="button" ng-click="vm.cancelEditData()">\n        <span class="glyphicon glyphicon-remove" aria-hidden="true"></span> \n        <span>Cancel</span>\n    </button>\n</span>'),e.put("list.tpl.html",'<div class="d-list">\n    <div ng-transclude class="d-list__multi-actions"></div>\n    <table ng-if="!responsiveMode" class="d-list-table">\n        <thead class="d-list-table__headers" ng-if="$list.$setup.enable.header">\n            <tr>\n                <th class="d-list-table__header" ng-if="$list.$setup.enable.checkboxes"></th>\n                <th class="d-list-table__header" ng-repeat="header in $list.$headers">\n                    <a href="" ng-if="$list.headerIsSortable(header)" ng-click="$list.sortBy(header)" class="d-list-table__header-sortable">\n                        {{$list.getHeaderLabel(header) | capitalize}}\n                        <i ng-if="$list.$sort.by === header" class="glyphicon" ng-class="{\'glyphicon-chevron-down\': $list.$sort.order === \'desc\', \'glyphicon-chevron-up\': $list.$sort.order === \'asc\'}" style="font-size: 10px; margin: 4px 0 0 4px"></i>\n                    </a>\n                    <span ng-if="!$list.headerIsSortable(header)">\n                        {{$list.getHeaderLabel(header) | capitalize}}\n                    </span>\n                </th>\n            </tr>\n        </thead>\n        <tfoot class="d-list-table__footer" ng-if="$list.$setup.enable.footer">\n        </tfoot>\n        <tbody class="d-list-table__body">\n            <tr ng-repeat="element in $list.$elements" class="d-list-table__body-row">\n                <td ng-if="$list.$setup.enable.checkboxes" class="d-list-table__body-cell d-list-table__body-cell-checkbox">\n                    <input type="checkbox" ng-model="element.$checked" />\n                </td>\n                <td ng-hide="$list.$edit" ng-repeat="header in $list.$headers" class="d-list-table__body-cell">\n                    <div ng-if="!$list.$setup.templates[header]">{{element[header]}}</div>\n                    <div ng-if="$list.$setup.templates[header]">\n                        <item data-template="$list.$setup.templates[header]" data-model="element[header]" data-row-model="element"></item>\n                    </div>\n                </td>\n                <td ng-show="$list.$edit" ng-repeat="header in $list.$headers" class="d-list-table__body-cell--edit">\n                    <div class="form-group">\n                        <edit-input data-value="element[header]" data-setup="$list.$setup.edit[header]"></edit-input>\n                    </div>\n                </td>\n            </tr>\n        </tbody>\n    </table>\n\n    <table ng-if="responsiveMode" class="d-list-table-small" ng-repeat="element in $list.$elements">\n        <tbody>\n            <tr ng-repeat="header in $list.$headers" class="d-list-table-small__row">\n                <td class="d-list-table-small__header">\n                    <a href="" ng-if="$list.headerIsSortable(header)" ng-click="$list.sortBy(header)" class="d-list-table-small__header-sortable">\n                        {{$list.getHeaderLabel(header) | capitalize}}\n                        <i ng-if="$list.$sort.by === header" class="glyphicon" ng-class="{\'glyphicon-chevron-down\': $list.$sort.order === \'desc\', \'glyphicon-chevron-up\': $list.$sort.order === \'asc\'}" style="font-size: 10px; margin: 4px 0 0 4px"></i>\n                    </a>\n                    <span ng-if="!$list.headerIsSortable(header)">\n                        {{$list.getHeaderLabel(header) | capitalize}}\n                    </span>\n                </td>\n                <td ng-hide="$list.$edit" class="d-list-table-small__body-cell">\n                    <div ng-if="!$list.$setup.templates[header]">{{element[header]}}</div>\n                    <div ng-if="$list.$setup.templates[header]">\n                        <item data-template="$list.$setup.templates[header]" data-model="element[header]" data-row-model="element"></item>\n                    </div>\n                </td>\n\n                <td ng-show="$list.$edit" class="d-list-table-small__body-cell--edit">\n                    <div class="form-group">\n                        <edit-input data-value="element[header]" data-setup="$list.$setup.edit[header]"></edit-input>\n                    </div>\n                </td>\n            </tr>\n        </tbody>\n    </table>\n\n    <section ng-if="$list.$setup.enable.pagination" class="d-list-pagination">\n        <div class="input-group d-list-pagination__page-links">\n            <span ng-bind="$list.$setup.i18n.pagination.prev" ng-click="$list.$pagination.pageDown()"\n                ng-disabled="$list.$pagination.data.page === 1" class="input-group-addon btn btn-default d-list-pagination__prev"></span>\n            <input type="text" class="form-control" ng-blur="$list.$pagination.ensureValidPage()"\n                ng-model="$list.$pagination.data.page" class="d-list-pagination__number"/>\n            <span ng-bind="$list.$setup.i18n.pagination.next" ng-click="$list.$pagination.pageUp()"\n                ng-disabled="$list.$pagination.data.page === $list.$pagination.totalPages()"\n                class="input-group-addon btn btn-default d-list-pagination__next"></span>\n        </div>\n        <div class="d-list-pagination-summary">\n            <div class="d-list-pagination-summary__items-number">Showing items: {{$list.$pagination.fromItem()}} - {{$list.$pagination.toItem()}} of {{$list.$pagination.data.total}}</div>\n            <div class="d-list-pagination-summary__selected">Selected: {{$list.selected()}}</div>\n            <div class="d-list-pagination-summary__total-pages">Total pages: {{$list.$pagination.totalPages()}}</div>\n            <br/>\n            <div ng-if="$list.$pagination.data.pageSizeOptions" class="d-list-pagination-summary__items-number-select btn-group">\n                <button ng-repeat="pageSizeOption in $list.$pagination.data.pageSizeOptions"\n                    ng-class="{active: pageSizeOption === $list.$pagination.data.pageSize}"\n                    ng-click="$list.$pagination.setPageSize(pageSizeOption)"\n                    type="button" class="btn btn-default">{{pageSizeOption}}</button>\n            </div>\n        </div>\n    </section>\n</div>\n')}]),function(){function e(){var e=this;e.url="http://api.icndb.com/jokes/random/38",e.els=[],e.setup={enable:{header:!0,footer:!1,sorting:!0,pagination:!0,filters:!0,checkboxes:!0},defaults:{sort:{order:"asc",by:"surname"},pagination:{pageSize:2,page:1,pageSizeOptions:[2,5,10]}},templates:{name:"<div>This is a custom template for <b>{{$item.value}}</b></div>"},edit:{name:{type:"select",data:["Olivia","Alex","Susanne","Winston"]},surname:{type:"select",dataUrl:"http://api.icndb.com/jokes/random/1"}},columns:{include:["name","surname","age"],exclude:["age"],order:[],sortables:["surname"],labels:{name:"Name own label"}}},e.elements=[{id:1,name:"Olivia",surname:"Newton",age:32},{id:2,name:"Oliver",surname:"Night",age:12},{id:3,name:"Felicia",surname:"Low",age:43},{id:4,name:"Alex",surname:"Night"},{id:5,name:"Martin",surname:"Fair",age:54}],e.fields=[{type:"text",label:"Name",ngModel:"name"},{type:"select",label:"Sex",ngModel:"sex",ngOptions:[{key:"male",value:"Male"},{key:"female",value:"Female"}]},{type:"checkbox",label:"Single?",ngModel:"single"}]}angular.module("d",["d.Filters","d.Actions","d.List","d.Keyboard","d.Helpers","ngSanitize","bsDropDown"]).controller("MainController",e),e.$inject=[]}(),function(){function e(){function e(e,t){t.on("click",function(){$(".dropdown-menu").not(t.next()).hide(),$(t).next().toggle()})}return{restrict:"A",link:e}}angular.module("bsDropDown",[]).directive("bsDropDown",e)}(),function(){angular.module("d.Helpers").filter("capitalize",function(){return function(e){return e?e.replace(/([^\W_]+[^\s-]*) */g,function(e){return e.charAt(0).toUpperCase()+e.substr(1).toLowerCase()}):""}})}(),function(){function e(){return{altPressed:!1}}angular.module("d.Keyboard").service("keyboardService",e)}(),function(){function e(){function e(e){var t=this;e.$watch("$parent.$parent.$list.$elements",function(e){t.elements=e})}return e.$inject=["$scope"],{transclude:!0,templateUrl:"action-box.tpl.html",replace:!0,controller:e,scope:{label:"@",size:"@",icon:"@"},controllerAs:"vm"}}angular.module("d.Actions").directive("actionBox",e)}(),function(){function e(){function e(){}return e.$inject=["$scope"],{restrict:"E",controller:e,templateUrl:"action.add-item.tpl.html",replace:!0}}angular.module("d.List").directive("actionAddItem",e)}(),function(){function e(){function e(e){function t(){var e=[];angular.forEach(n.elements,function(t,n){t.$checked&&e.push(n)}),e.length>0&&angular.forEach(e,function(e){n.elements.splice(e,1)})}var n=this;n.deleteItems=t,e.$watch("$parent.vm.elements",function(e){n.elements=e})}return e.$inject=["$scope"],{restrict:"E",controller:e,controllerAs:"vm",templateUrl:"action.delete-items.tpl.html",replace:!0}}angular.module("d.List").directive("actionDelete",e)}(),function(){function e(e){function t(t){function n(){angular.forEach(a.elements,function(t){e.select(t)})}var a=this;a.selectAll=n,t.$watch("$parent.vm.elements",function(e){a.elements=e})}return t.$inject=["$scope"],{templateUrl:"action.select-all.tpl.html",replace:!0,controller:t,controllerAs:"savm"}}angular.module("d.Actions").directive("actionSelectAll",e),e.$inject=["dCheckboxesService"]}(),function(){function e(e){function t(t){function n(){angular.forEach(a.elements,function(t){e.invert(t)})}var a=this;a.selectInverse=n,t.$watch("$parent.vm.elements",function(e){a.elements=e})}return t.$inject=["$scope"],{templateUrl:"action.select-inverse.tpl.html",replace:!0,controller:t,controllerAs:"sivm"}}angular.module("d.Actions").directive("actionSelectInverse",e),e.$inject=["dCheckboxesService"]}(),function(){function e(e){function t(t){function n(){angular.forEach(a.elements,function(t){e.unselect(t)})}var a=this;a.selectNone=n,t.$watch("$parent.vm.elements",function(e){a.elements=e})}return t.$inject=["$scope"],{templateUrl:"action.select-none.tpl.html",replace:!0,controller:t,controllerAs:"snvm"}}angular.module("d.Actions").directive("actionSelectNone",e),e.$inject=["dCheckboxesService"]}(),function(){function e(e){function t(t){function n(){e.$broadcast(a.listName+"Reload",a.$model)}var a=this;a.$model={},a.submit=n,a.autoSubmit&&t.$watch("$filters.$model",n,!0)}return t.$inject=["$scope"],{templateUrl:"filters.tpl.html",replace:!0,scope:{listName:"@",$fields:"&fields",autoSubmit:"@"},bindToController:!0,controller:t,controllerAs:"$filters"}}angular.module("d.Filters").directive("dFilters",e),e.$inject=["$rootScope"]}(),function(){function e(){function e(e){e.$checked=!0}function t(e){e.$checked=!1}function n(e){e.$checked=!e.$checked}function a(e){return e.$checked}return{select:e,unselect:t,invert:n,isChecked:a}}angular.module("d.Helpers").service("dCheckboxesService",e)}(),function(){function e(e){function t(e,t,n){e.size=n.size}function n(t){function n(){t.$parent.$list.$edit=!t.$parent.$list.$edit}function a(){e.$broadcast("dList.cancelEditData"),n()}function i(){e.$broadcast("dList.saveEditData"),n()}var l=this;l.changeEditMode=n,l.saveEditData=i,l.cancelEditData=a}return n.$inject=["$scope"],{templateUrl:"edit-mode-button.tpl.html",replace:!0,link:t,controller:n,controllerAs:"vm"}}angular.module("d.List").directive("editModeButton",e),e.$inject=["$rootScope"]}(),function(){function e(e,t){function n(e){function n(){a.setup.dataUrl?t.get(a.setup.dataUrl).then(function(){a.selectDataOptions=["Newton","Barry","Night"]},function(){console.log("CAUTION: Error while loading external select options from "+a.setup.dataUrl)}):a.setup.data&&(a.selectDataOptions=a.setup.data)}var a=this;a.selectDataOptions=[],a.editValue=e.value,a.setup=e.setup();var i=e.$watch("setup",function(e){e()&&(n(),i())});e.$on("dList.saveEditData",function(){e.value=a.editValue}),e.$on("dList.cancelEditData",function(){a.editValue=e.value})}function a(t,n){n.bind("keyup",function(t){18===t.keyCode&&(e.altPressed=!1)}),n.bind("keydown",function(t){if(18===t.keyCode&&(e.altPressed=!0),e.altPressed){var a,i,l;switch(t.keyCode){case 37:a=angular.element(n.parent().parent()[0].previousElementSibling);break;case 38:var a=angular.element(angular.element(n.parent().parent().parent()[0].previousElementSibling).find("td")[n.parent().parent()[0].cellIndex]);break;case 39:var a=n.parent().parent().next();break;case 40:var a=angular.element(n.parent().parent().parent().next().find("td")[n.parent().parent()[0].cellIndex])}i=a.find("select")[0],l=a.find("input")[0],i&&i.focus(),l&&l.focus()}})}return n.$inject=["$scope"],{templateUrl:"edit-input.tpl.html",replace:!0,controller:n,controllerAs:"vm",link:a,scope:{value:"=",setup:"&"}}}angular.module("d.List").directive("editInput",e),e.$inject=["keyboardService","$http"]}(),function(){function e(e){return{link:function(t,n){n.html(t.template()),e(n.contents())(t)},scope:{template:"&",value:"&model",row:"&rowModel"},controller:["$scope",function(e){var t=this;t.value=e.value(),t.row=e.row()}],controllerAs:"$item"}}angular.module("d.List").directive("item",e),e.$inject=["$compile"]}(),function(){function e(e,t,n,a,i,l,s){function o(e){function t(e){return!f.$setup.columns||!f.$setup.columns.sortables||f.$setup.columns.sortables.indexOf(e)>-1}function a(e){return f.$headerLabels&&f.$headerLabels[e]?f.$headerLabels[e]:e}function o(e){var t=[];for(var n in e)e.hasOwnProperty(n)&&"$"!==n[0]&&(f.$setup.columns?(f.$setup.columns.include?f.$setup.columns.include&&f.$setup.columns.include.indexOf(n)>-1&&t.push(n):t.push(n),f.$setup.columns.exclude&&f.$setup.columns.exclude.indexOf(n)>-1&&t.indexOf(n)>-1&&t.splice(t.indexOf(n),1)):t.push(n));return t}function r(){var e=0;return angular.forEach(f.$elements,function(t){l.isChecked(t)&&e++}),e}function d(e){f.$sort.by=e,f.$sort.order=f.$sort.order&&"asc"===f.$sort.order?"desc":"asc",f.$sort.order=f.$sort.order,g()}function c(t){if(e.url()){var a=angular.extend({},t,f.$sort,f.$pagination.data);i.getData(f.$setup.data.onSuccess,f.$setup.data.onError,a).then(function(e){m=n("orderBy")(e,f.$sort.by,"desc"===f.$sort.order),u(),f.$pagination.data.total=m.length,p()},function(){console.log("The remote data for the table couldn't be retrieved")})}else t?(m=t.rows?t.rows:t,f.$pagination.data.total=t.count?t.count:m.length):(m=e.elements(),f.$pagination.data.total=m.length),u(),p()}function u(){angular.forEach(m,function(e){angular.extend(e,{$checked:!1})})}function p(){f.$elements=e.url()?m.slice((f.$pagination.data.page-1)*f.$pagination.data.pageSize,f.$pagination.data.pageSize*f.$pagination.data.page):m}function g(e){f.$setup.filters&&f.$setup.filters.onChange&&f.$setup.filters.onChange(angular.extend({},e?e:{},{sort:f.$sort,pagination:f.$pagination.data})).then(function(e){c(e)})}var f=this,m=[];i.setUrl(e.url()),f.$name=e.name,f.selected=r,f.$edit=!1,f.sortBy=d,f.$setup=angular.extend({},s.getSetup(),e.setup()?e.setup():{}),f.$headerLabels=f.$setup.columns&&f.$setup.columns.labels?f.$setup.columns.labels:{},f.$sort=f.$setup&&f.$setup.defaults?f.$setup.defaults.sort:{},f.$pagination={data:{pageSize:f.$setup.defaults.pagination.pageSize,page:f.$setup.defaults.pagination.page,pageSizeOptions:f.$setup.defaults.pagination.pageSizeOptions,total:null},pageUp:function(){this.data.page!==this.totalPages()&&(this.data.page++,g())},pageDown:function(){1!==this.data.page&&(this.data.page--,g())},ensureValidPage:function(){this.data.page<1?this.data.page=1:this.data.page>this.totalPages()&&(this.data.page=this.totalPages()),g()},totalPages:function(){var e=Math.round(this.data.total/this.data.pageSize);return 0===e?1:e},fromItem:function(){return(this.data.page-1)*this.data.pageSize===0?1:(this.data.page-1)*this.data.pageSize+1},toItem:function(){return this.data.page*this.data.pageSize>this.data.total?this.data.total:this.data.page*this.data.pageSize},setPageSize:function(e){this.data.pageSize=e,this.data.page=1,g()}},f.headerIsSortable=t,f.getHeaderLabel=a,function(){e.filterBound?g():c()}(),e.$watch(angular.bind(f,function(){return f.$elements}),function(e){e&&e[0]&&(f.$headers=o(e[0]))}),e.$on(f.$name+"Reload",function(e,t){g(t)})}return o.$inject=["$scope"],{templateUrl:"list.tpl.html",replace:!0,transclude:!0,scope:{elements:"&",setup:"&",url:"&",name:"@",responsiveMode:"=responsive",filterBound:"@"},controller:o,controllerAs:"$list"}}angular.module("d.List").directive("dList",e),e.$inject=["$http","$rootScope","$filter","$compile","dListService","dCheckboxesService","dListSetup"]}(),function(){function e(){function e(){var e=this;return{getSetup:function(){return e.setup}}}this.setup={enable:{header:!0,footer:!1,sorting:!0,pagination:!0,filters:!0,checkboxes:!0},defaults:{sort:{order:"asc",by:"surname"},pagination:{pageSize:10,page:1,pageSizeOptions:[10,15,20,50]}},i18n:{locale:"en_US",pagination:{next:"Next",prev:"Previous",start:"Start",end:"End"}},data:{onSuccess:function(e){return e.value},onError:function(e){return e}}},this.$get=e}angular.module("d.List").provider("dListSetup",e)}(),function(){function e(e){function t(e){i=e}function n(){return i}function a(t,n,a){return e.get(i,{method:"GET",params:a}).then(function(e){return t(e.data)},function(e){return n(e.data)})}var i;return{setUrl:t,getUrl:n,getData:a}}angular.module("d.List").service("dListService",e),e.$inject=["$http"]}();